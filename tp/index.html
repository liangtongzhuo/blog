<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=320,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>理想之光·社区艺术节，畅玩邀请</title>


    <script src="./jquery-3.1.1.min.js"></script>
    <script src="./html2canvas.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./canvas2image.js" type="text/javascript" charset="utf-8"></script>

    <script src="https://cdn.bootcss.com/vConsole/3.3.4/vconsole.min.js"></script>


    <style type="text/css" media="screen">
        .need {
            position: relative;
        }

        img {
            width: 100%;
            border: 0;
            margin: 0;
            padding: 0;
            display: inherit;
        }

        .button-list {
            position: fixed;
            bottom: 20px;
            right: 20px;
            text-align: right;
        }

        button {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: #272c5a;
            line-height: 20px;
            text-align: center;
            font-size: 15px;
            font-weight: 200px;
            cursor: pointer;
            border: 0px;
            color: white;
            outline: none;
        }

        .content {
            position: absolute;
            top: 140px;
            width: 85%;
            margin-left: 7.5%;
            background-color: rgba(255,255,255,0.8);
            border-radius: 8px;
            color: black;
            min-height: 50px;
            padding: 8px;
            box-sizing: border-box;
        }

        p {
            margin: 0;
            border: 0;
            padding: 0;
            line-height: 22px;
            font-size: 12px;
            font-weight: 500;
        }

        body {
            font-family: "Microsoft Yahei";
        }
    </style>
</head>

<body style="padding: 0;margin: 0;">
    <div class="bg">
        <div class="need">
            <div class="content">
                <p> <span class="clinetNmae">_______</span> 您好：</p>
                <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我是您的生活顾问 <span class="adviserName">_______</span>，这个十一，邀请您同您的家人一起，来理想国和艺术家们一起玩转社区节日。</p>
                <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;好玩的艺术展，好听的草坪音乐会，好吃的美食集；同时联合郑州艺术名家为孩子们特别呈现了一场美学启蒙的盛宴。
                </p>
                <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;每天都有新花样，来理想国过个不一样的十一假期吧！</p>
                <p style="text-align: right;">2020年9月15日</p>
            </div>


            <div class="div-img">

            </div>
            <img class="bg-img" src="./background.jpg">
            <!-- <img class="bg-img" src="http://file.liangtongzhuo.com/094ed1fe7bd2dc758828.jpeg/background.jpeg"> -->
        </div>
        <div class="button-list"><button type="button" class="picture">生成<br />海报</button></div>
    </div>
</body>



<script>

    function getOS() { // 获取当前操作系统
        var os;
        if (navigator.userAgent.indexOf('Android') > -1 || navigator.userAgent.indexOf('Linux') > -1) {
            os = 'Android';
        } else if (navigator.userAgent.indexOf('iPhone') > -1 || navigator.userAgent.indexOf('iPad') > -1) {
            os = 'iOS';
        } else if (navigator.userAgent.indexOf('Windows Phone') > -1) {
            os = 'WP';
        } else {
            os = 'Others';
        }
        return os;
    }


    // 点击转成canvas，最后用于生成图片
    $('.picture').click(function (e) {
        // 输入名字
        const clinetNmae = prompt('请输入客户名字');
        const adviserName = prompt('请输入置业顾问名字');
        // 修改名字
        document.querySelector('.clinetNmae').innerHTML = clinetNmae
        document.querySelector('.adviserName').innerHTML = adviserName

        // 渲染图片，并且加到页面中查看效果
        document.querySelector('.div-img').innerHTML = ''
        $('.bg-img').show();

        // 调用html2canvas插件
        html2canvas(document.querySelector(".need")).then(function (canvas) {
            const w = $('.bg-img').width()
            const h = $('.bg-img').height()
            // 这里的判断用于区分移动端和pc端
            if (getOS() == "Others") {
                // 调用Canvas2Image插件
                Canvas2Image.saveAsImage(canvas, w, h, 'png', 'img');
            } else {
                const img = Canvas2Image.convertToImage(canvas, w * 2, h * 2);
                $(".div-img").append(img);
            }
            alert('温馨提示，长按保存至相册')
            // 隐藏图片
            $('.bg-img').hide();
            document.querySelector('.picture').innerHTML = '重新<br />生成';
        })

    });


    // const vConsole = new VConsole();
</script>

</html>